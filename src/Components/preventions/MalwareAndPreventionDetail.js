import React, { useState, useEffect } from 'react';
import { useParams } from 'react-router-dom';
import axios from 'axios';
import Accordion from 'react-bootstrap/Accordion';
import Card from 'react-bootstrap/Card';
import Button from 'react-bootstrap/Button';

const Prevention = () => {
    const [preventions, setPreventions] = useState([]);
    const { malwareId } = useParams();

    useEffect(() => {
        const fetchPrevention = async () => {
            try {
                const response = await axios.get(`http://localhost:3000/api/v1/malwares/${malwareId}/preventions`);
                setPreventions(response.data);
            } catch (error) {
                console.error("Error fetching malware prevention:", error);
            }
        };

        fetchPrevention();
    }, [malwareId]);

    return (
        <div className="container mt-5">
            <h2 className="mb-4">Preventions for Malware ID: {malwareId}</h2>
            <Accordion>
                {preventions.map((prevention, index) => (
                    <Card key={prevention.id}>
                        <Card.Header>
                            <Accordion.Toggle as={Button} variant="link" eventKey={index.toString()}>
                                {prevention.name} - Date Added: {prevention.added_on}
                            </Accordion.Toggle>
                        </Card.Header>
                        <Accordion.Collapse eventKey={index.toString()}>
                            <Card.Body>
                                {prevention.description?.body}
                            </Card.Body>
                        </Accordion.Collapse>
                    </Card>
                ))}
            </Accordion>
        </div>
    );
}

export default Prevention;
